# Quantum Picture Book サービス要件定義書

## 1. サービス概要
子供の名前の由来をストーリーの中心に据えた、新しい形のパーソナライズ絵本制作サービス。量子アニーリングとAIを活用し、質の高い絵本を数分で生成します。

## 2. 背景
- パーソナライズ絵本市場の現状
  - 既存サービスは名前の文字を物語に組み込む表面的なカスタマイズに留まる
  - 名前に込められた本当の物語が活かされていない
  - 家族の想いを伝える機会が限られている

## 3. 目的
- 名前に込められた想いを次世代に伝える
  - 親から子への想いをストーリー化
  - 名前を付けた際のエピソードの視覚化
- 日本の文化要素を活かした独自の世界観の構築
  - ひらがなベースのストーリー展開
  - 日本的な象徴やモチーフの活用

## 4. 既存サービス（Wonderbly）の分析
- 基本機能
  - 子供の名前をストーリーに組み込む
  - 性別や年齢に応じたキャラクター選択
  - 定型のストーリーラインの提供

- 特徴と制限
  - 名前の文字を物語の要素として使用
  - 英語ベースの展開
  - 画一的なストーリー構造
  - カスタマイズの自由度が限定的

## 5. 拡張要件

### 5.1 日本語化対応
- ひらがなベースのストーリー展開
  - スペルからひらがなへの変更
  - 各ひらがなに対応する動物・キャラクターの設定
  - 日本的な場所・シーンでのメッセージ伝達

- 日本的要素の導入
  - 導き手としての以下のキャラクター：
    - 干支（12種）
    - 自然現象（太陽、月、虹、星）
    - 気象要素（雲、雨、雪、風）
    - 日本の象徴的な植物（桜、竹、菊、ひまわり、梅、モミジ）

### 5.2 ストーリー構造の拡張
- 名前の文字別ストーリー
  - 各文字につき2ページ程度の展開
  - 導き手キャラクターによるメッセージ
  - 場所と関連付けたシーン展開

- 名前の由来ストーリー
  - 親ユーザーによる入力内容の反映
  - 起承転結による4部構成
    - 各パートで複数の候補を生成
    - 量子アニーリングによる最適な組み合わせのレコメンド
    - 親による最終選択
  - 前半の導き手キャラクターの再登場

## 6. 機能要件

### 6.1 ユーザー入力機能
- 基本情報入力
  - 子供の名前（ひらがなであるということが新規）
  - 性別
  - 生年月日
  - アバター選択

- 名前の由来情報入力
  - 特別なエピソード

- カスタマイズ選択
  - ストーリーパターン選択（起承転結各パートで複数のオプション）
  - 登場キャラクターの好み設定
  - 背景シーンの選択

### 6.2 ユーザー操作手順
- 基本情報の入力
  - お子様の名前（ひらがな）
  - 性別
  - 生年月日
  - アバター選択（お好みの見た目）

- 名前の由来情報入力
  - ストーリー入力画面で以下を記入
    - 名前の由来（なぜその名前を選んだか）
    - 込められた願い
    - 名付けに関する思い出やエピソード(あれば)
  
  - 入力のポイント
    - 具体的なエピソードを含める
    - 感情や想いを言葉で表現
    - 家族の歴史や願いを盛り込む

- カスタマイズ設定
  - ストーリーの好み選択
    - 好きな日本の伝統要素（桜、紅葉など）
    - 好きな動物や自然現象
    - 季節の希望（特定の季節にまつわる思い出など）

### 6.3 コンテンツ生成機能
- ストーリー(絵本の文字)の生成
  - 量子アニーリングによる最適なストーリー構造の決定
  - AIを活用した自然な文章生成
  - 名前の由来の物語化と感情表現の最適化
  - 選択されたパターンに基づく展開

- 絵の生成
  - AIによる高品質なイラスト生成
  - テキストとビジュアルの調和

## 7. システム構成

### 7.1 ストーリー生成フロー
1. 基本ストーリー生成（LLM_A）
   - ユーザー入力を基に大まかなストーリーラインを生成
   - 主人公と導き手による地球冒険物語の構築
   - 名前の由来とメッセージの物語への組み込み

2. 舞台設定最適化（量子アニーリング）
   - 各ページの最適な舞台設定を決定
   - 以下の要素の組み合わせを最適化：
     - ステージ（季節、場所）
     - 導き手（動物、自然現象、植物など）
     - メッセージ展開
     - ストーリーの流れ

3. 詳細コンテンツ生成（LLM）
   - 最適化された舞台設定に基づくセンテンス生成
   - イラスト生成のためのプロンプト作成

### 7.2 量子アニーリングによる最適化

#### 目的関数
```
最大化 F = w1*Σ(導き手ステージ整合性) 
        + w2*Σ(メッセージ分散度) 
        + w3*Σ(ストーリー展開整合性)
        + w4*Σ(ページ間連続性)
```

#### 最適化要素
1. 導き手×ステージ×センテンス整合性
   - 季節と導き手の適合度
   - 場所と導き手の相性
   - メッセージと導き手の調和

2. メッセージの分散と一貫性
   - 親からのメッセージの適切な分散
   - テーマの一貫性維持
   - 重複の回避

3. ストーリー展開とステージの調和
   - 展開の強度と舞台設定のマッチング
   - 感情表現と環境の整合性

4. ページ間の連続性評価
   - 整合性パラメータによる品質管理
   - ブラックボックス最適化による閾値設定
   - 閾値を下回る場合の再生成トリガー

#### 制約条件
- 同一導き手の過度な重複を防止
- 季節の急激な変化を制限
- メッセージの均等な分散を確保
